<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script type="text/javascript">
var gl;
var shaderProgram;
var uPMatrix;
var vertexPositionBuffer;
var vertexColorBuffer;
var vertexPosition = [];
var vertexNormal = [];
var indexes = [];
var vertexCoordsBuffer;
var vertexNormalBuffer;
var indexBuffer;

function MatrixMul(a,b) //Mnożenie macierzy
{
  let c = [
  0,0,0,0,
  0,0,0,0,
  0,0,0,0,
  0,0,0,0
  ]
  for(let i=0;i<4;i++)
  {
    for(let j=0;j<4;j++)
    {
      c[i*4+j] = 0.0;
      for(let k=0;k<4;k++)
      {
        c[i*4+j]+= a[i*4+k] * b[k*4+j];
      }
    }
  }
  return c;
}

function MatrixTransposeInverse(m)
{
  let r = [
        0, 0, 0, 0,
        0, 0, 0, 0,
        0, 0, 0, 0,
        0, 0, 0, 0
    ];
  r[0] = m[5]*m[10]*m[15] - m[5]*m[14]*m[11] - m[6]*m[9]*m[15] + m[6]*m[13]*m[11] + m[7]*m[9]*m[14] - m[7]*m[13]*m[10];
  r[1] = -m[1]*m[10]*m[15] + m[1]*m[14]*m[11] + m[2]*m[9]*m[15] - m[2]*m[13]*m[11] - m[3]*m[9]*m[14] + m[3]*m[13]*m[10];
  r[2] = m[1]*m[6]*m[15] - m[1]*m[14]*m[7] - m[2]*m[5]*m[15] + m[2]*m[13]*m[7] + m[3]*m[5]*m[14] - m[3]*m[13]*m[6];
  r[3] = -m[1]*m[6]*m[11] + m[1]*m[10]*m[7] + m[2]*m[5]*m[11] - m[2]*m[9]*m[7] - m[3]*m[5]*m[10] + m[3]*m[9]*m[6];

  r[4] = -m[4]*m[10]*m[15] + m[4]*m[14]*m[11] + m[6]*m[8]*m[15] - m[6]*m[12]*m[11] - m[7]*m[8]*m[14] + m[7]*m[12]*m[10];
  r[5] = m[0]*m[10]*m[15] - m[0]*m[14]*m[11] - m[2]*m[8]*m[15] + m[2]*m[12]*m[11] + m[3]*m[8]*m[14] - m[3]*m[12]*m[10];
  r[6] = -m[0]*m[6]*m[15] + m[0]*m[14]*m[7] + m[2]*m[4]*m[15] - m[2]*m[12]*m[7] - m[3]*m[4]*m[14] + m[3]*m[12]*m[6];
  r[7] = m[0]*m[6]*m[11] - m[0]*m[10]*m[7] - m[2]*m[4]*m[11] + m[2]*m[8]*m[7] + m[3]*m[4]*m[10] - m[3]*m[8]*m[6];

  r[8] = m[4]*m[9]*m[15] - m[4]*m[13]*m[11] - m[5]*m[8]*m[15] + m[5]*m[12]*m[11] + m[7]*m[8]*m[13] - m[7]*m[12]*m[9];
  r[9] = -m[0]*m[9]*m[15] + m[0]*m[13]*m[11] + m[1]*m[8]*m[15] - m[1]*m[12]*m[11] - m[3]*m[8]*m[13] + m[3]*m[12]*m[9];
  r[10] = m[0]*m[5]*m[15] - m[0]*m[13]*m[7] - m[1]*m[4]*m[15] + m[1]*m[12]*m[7] + m[3]*m[4]*m[13] - m[3]*m[12]*m[5];
  r[11] = -m[0]*m[5]*m[11] + m[0]*m[9]*m[7] + m[1]*m[4]*m[11] - m[1]*m[8]*m[7] - m[3]*m[4]*m[9] + m[3]*m[8]*m[5];

  r[12] = -m[4]*m[9]*m[14] + m[4]*m[13]*m[10] + m[5]*m[8]*m[14] - m[5]*m[12]*m[10] - m[6]*m[8]*m[13] + m[6]*m[12]*m[9];
  r[13] = m[0]*m[9]*m[14] - m[0]*m[13]*m[10] - m[1]*m[8]*m[14] + m[1]*m[12]*m[10] + m[2]*m[8]*m[13] - m[2]*m[12]*m[9];
  r[14] = -m[0]*m[5]*m[14] + m[0]*m[13]*m[6] + m[1]*m[4]*m[14] - m[1]*m[12]*m[6] - m[2]*m[4]*m[13] + m[2]*m[12]*m[5];
  r[15] = m[0]*m[5]*m[10] - m[0]*m[9]*m[6] - m[1]*m[4]*m[10] + m[1]*m[8]*m[6] + m[2]*m[4]*m[9] - m[2]*m[8]*m[5];

  var det = m[0]*r[0] + m[1]*r[4] + m[2]*r[8] + m[3]*r[12];
  for (var i = 0; i < 16; i++) r[i] /= det;
  
  let rt = [ r[0], r[4], r[8], r[12],
             r[1], r[5], r[9], r[13],
             r[2], r[6], r[10], r[14],
             r[3], r[7], r[11], r[15]
             ];
  
  return rt;
}

function CreateIdentytyMatrix()
{
  return [
  1,0,0,0, //Macierz jednostkowa
  0,1,0,0,
  0,0,1,0,
  0,0,0,1
  ];
}

function CreateTranslationMatrix(tx,ty,tz)
{
  return  [
  1,0,0,0,
  0,1,0,0,
  0,0,1,0,
  tx,ty,tz,1
  ];
}

function CreateScaleMatrix(sx,sy,sz)
{
  return [
  sx,0,0,0,
  0,sy,0,0,
  0,0,sz,0,
  0,0,0,1
  ];
}

function CreateRotationZMatrix(angleZ)
{
  return [
  +Math.cos(angleZ*Math.PI/180.0),+Math.sin(angleZ*Math.PI/180.0),0,0,
  -Math.sin(angleZ*Math.PI/180.0),+Math.cos(angleZ*Math.PI/180.0),0,0,
  0,0,1,0,
  0,0,0,1
  ];
}

function CreateRotationYMatrix(angleY)
{
  return [
  +Math.cos(angleY*Math.PI/180.0),0,-Math.sin(angleY*Math.PI/180.0),0,
  0,1,0,0,
  +Math.sin(angleY*Math.PI/180.0),0,+Math.cos(angleY*Math.PI/180.0),0,
  0,0,0,1
  ];
}

function CreateRotationXMatrix(angleX)
{
  return [
  1,0,0,0,
  0,+Math.cos(angleX*Math.PI/180.0),+Math.sin(angleX*Math.PI/180.0),0,
  0,-Math.sin(angleX*Math.PI/180.0),+Math.cos(angleX*Math.PI/180.0),0,
  0,0,0,1
  ];
}

function createRect(mx,my,mz,dax,day,daz,dbx,dby,dbz)
{
  p1x = mx;             p1y = my;             p1z = mz;
  p2x = mx + dax;       p2y = my + day;       p2z = mz + daz;
  p3x = mx + dbx;       p3y = my + dby;       p3z = mz + dbz;
  p4x = mx + dax + dbx; p4y = my + day + dby; p4z = mz + daz + dbz;
  
  let vertexPosition = [p1x,p1y,p1z, p2x,p2y,p2z, p4x,p4y,p4z,  //Pierwszy trójkąt
                        p1x,p1y,p1z, p4x,p4y,p4z, p3x,p3y,p3z]; //Drugi trójkąt
                        
  return vertexPosition;
}

function createNormal(p1x,p1y,p1z,p2x,p2y,p2z,p3x,p3y,p3z) //Wyznaczenie wektora normalnego dla trójkąta
{
  let v1x = p2x - p1x;
  let v1y = p2y - p1y;
  let v1z = p2z - p1z;
  
  let v2x = p3x - p1x;
  let v2y = p3y - p1y;
  let v2z = p3z - p1z;
  
  let v3x =  v1y*v2z - v1z*v2y;
  let v3y =  v1z*v2x - v1x*v2z;
  let v3z =  v1x*v2y - v1y*v2x;
  
  vl = Math.sqrt(v3x*v3x+v3y*v3y+v3z*v3z); //Obliczenie długości wektora
   
  v3x/=vl; //Normalizacja na zakreś -1 1
  v3y/=vl;
  v3z/=vl;
  
  let vertexNormal = [v3x,v3y,v3z, v3x,v3y,v3z, v3x,v3y,v3z];
  return vertexNormal;
}

function CreateVillage(x,y,z,dx,dy,dz)
{
  //Opis sceny 3D, położenie punktów w przestrzeni 3D w formacie X,Y,Z 
  let vertexPosition = [];
  let vertexNormal = [];
  let vertexindexes = [];
  vertexPosition.push(...[0,0,0]);
  vertexPosition.push([4.515373,-0.709947,0.09965]);
vertexPosition.push([4.515373,0.202479,0.09965]);
vertexPosition.push([4.672957,-0.709947,-0.484772]);
vertexPosition.push([4.672957,0.202479,-0.484772]);
vertexPosition.push([6.647208,-0.712776,3.121034]);
vertexPosition.push([3.602495,-0.712776,2.218257]);
vertexPosition.push([8.228721,-0.712776,-2.21279]);
vertexPosition.push([5.184007,-0.712776,-3.115566]);
vertexPosition.push([5.915127,2.56601,0.000686]);
vertexPosition.push([6.647208,0.92554,3.121034]);
vertexPosition.push([5.917126,2.56601,0.001279]);
vertexPosition.push([3.602495,0.92554,2.218257]);
vertexPosition.push([5.914089,2.56601,0.004189]);
vertexPosition.push([8.228721,0.92554,-2.21279]);
vertexPosition.push([5.916088,2.56601,0.004781]);
vertexPosition.push([5.184007,0.92554,-3.115566]);
vertexPosition.push([3.88997,-0.324827,1.248715]);
vertexPosition.push([6.957142,-0.324827,2.075749]);
vertexPosition.push([6.957142,0.30295,2.075749]);
vertexPosition.push([3.88997,0.30295,1.248715]);
vertexPosition.push([4.068486,-0.324827,0.646652]);
vertexPosition.push([7.135657,-0.324827,1.473686]);
vertexPosition.push([4.068486,0.30295,0.646652]);
vertexPosition.push([7.135657,0.30295,1.473686]);
vertexPosition.push([4.698541,-0.296053,-1.47828]);
vertexPosition.push([7.765713,-0.296053,-0.651246]);
vertexPosition.push([7.765713,0.331724,-0.651246]);
vertexPosition.push([4.698541,0.331724,-1.47828]);
vertexPosition.push([7.944228,-0.296053,-1.253309]);
vertexPosition.push([4.877057,-0.296053,-2.080343]);
vertexPosition.push([4.877057,0.331724,-2.080343]);
vertexPosition.push([7.944228,0.331724,-1.253309]);
vertexPosition.push([4.251751,-0.709947,0.028567]);
vertexPosition.push([4.251751,-0.316457,0.028567]);
vertexPosition.push([4.251751,0.202479,0.028567]);
vertexPosition.push([4.423874,-0.709947,-0.551935]);
vertexPosition.push([4.423874,0.202479,-0.551935]);
vertexPosition.push([-15.373817,-1.072226,-7.503901]);
vertexPosition.push([-15.373817,-0.1598,-7.503901]);
vertexPosition.push([-15.426517,-1.072226,-6.900904]);
vertexPosition.push([-15.426517,-0.1598,-6.900904]);
vertexPosition.push([-18.002268,-1.075055,-10.10481]);
vertexPosition.push([-14.846448,-1.075055,-9.749724]);
vertexPosition.push([-18.624317,-1.075055,-4.576346]);
vertexPosition.push([-15.468498,-1.075055,-4.221261]);
vertexPosition.push([-16.73455,2.203731,-7.161104]);
vertexPosition.push([-18.002268,0.563261,-10.10481]);
vertexPosition.push([-16.736624,2.203731,-7.161337]);
vertexPosition.push([-14.846448,0.563261,-9.749724]);
vertexPosition.push([-16.734142,2.203731,-7.164734]);
vertexPosition.push([-18.624317,0.563261,-4.576346]);
vertexPosition.push([-16.736216,2.203731,-7.164967]);
vertexPosition.push([-15.468498,0.563261,-4.221261]);
vertexPosition.push([-14.95952,-0.687106,-8.744802]);
vertexPosition.push([-18.124172,-0.687106,-9.02138]);
vertexPosition.push([-18.124172,-0.059329,-9.02138]);
vertexPosition.push([-14.95952,-0.059329,-8.744802]);
vertexPosition.push([-15.029735,-0.687106,-8.120769]);
vertexPosition.push([-18.194387,-0.687106,-8.397347]);
vertexPosition.push([-15.029735,-0.059329,-8.120769]);
vertexPosition.push([-18.194387,-0.059329,-8.397347]);
vertexPosition.push([-15.277552,-0.658332,-5.918294]);
vertexPosition.push([-18.442205,-0.658332,-6.194873]);
vertexPosition.push([-18.442205,-0.030555,-6.194873]);
vertexPosition.push([-15.277552,-0.030555,-5.918294]);
vertexPosition.push([-18.512421,-0.658332,-5.57084]);
vertexPosition.push([-15.347767,-0.658332,-5.294261]);
vertexPosition.push([-15.347767,-0.030555,-5.294261]);
vertexPosition.push([-18.512421,-0.030555,-5.57084]);
vertexPosition.push([-15.101818,-1.072226,-7.480129]);
vertexPosition.push([-15.101818,-0.678736,-7.480129]);
vertexPosition.push([-15.101818,-0.1598,-7.480129]);
vertexPosition.push([-15.169518,-1.072226,-6.878444]);
vertexPosition.push([-15.169518,-0.1598,-6.878444]);
vertexPosition.push([-8.410776,-1.640293,-13.379518]);
vertexPosition.push([-8.410776,-0.727868,-13.379518]);
vertexPosition.push([-8.916618,-1.640293,-13.047095]);
vertexPosition.push([-8.916618,-0.727868,-13.047095]);
vertexPosition.push([-7.999106,-1.643123,-17.054298]);
vertexPosition.push([-6.321561,-1.643123,-14.357794]);
vertexPosition.push([-12.722924,-1.643123,-14.115522]);
vertexPosition.push([-11.045379,-1.643123,-11.41902]);
vertexPosition.push([-9.523243,1.635663,-14.234808]);
vertexPosition.push([-7.999106,-0.004806,-17.054298]);
vertexPosition.push([-9.524343,1.635663,-14.236579]);
vertexPosition.push([-6.321561,-0.004806,-14.357794]);
vertexPosition.push([-9.520142,1.635663,-14.236738]);
vertexPosition.push([-12.722924,-0.004806,-14.115522]);
vertexPosition.push([-9.521242,1.635663,-14.238508]);
vertexPosition.push([-11.045379,-0.004806,-11.41902]);
vertexPosition.push([-7.180222,-1.255173,-13.823606]);
vertexPosition.push([-8.924847,-1.255173,-16.478376]);
vertexPosition.push([-8.924847,-0.627397,-16.478376]);
vertexPosition.push([-7.180222,-0.627397,-13.823606]);
vertexPosition.push([-7.713429,-1.255173,-13.491888]);
vertexPosition.push([-9.458054,-1.255173,-16.14666]);
vertexPosition.push([-7.713429,-0.627397,-13.491888]);
vertexPosition.push([-9.458054,-0.627397,-16.14666]);
vertexPosition.push([-9.595343,-1.2264,-12.321115]);
vertexPosition.push([-11.339968,-1.2264,-14.975885]);
vertexPosition.push([-11.339968,-0.598623,-14.975885]);
vertexPosition.push([-9.595343,-0.598623,-12.321115]);
vertexPosition.push([-11.873175,-1.2264,-14.644167]);
vertexPosition.push([-10.12855,-1.2264,-11.989396]);
vertexPosition.push([-10.12855,-0.598623,-11.989396]);
vertexPosition.push([-11.873175,-0.598623,-14.644167]);
vertexPosition.push([-8.260826,-1.640293,-13.151341]);
vertexPosition.push([-8.260826,-1.246804,-13.151341]);
vertexPosition.push([-8.260826,-0.727868,-13.151341]);
vertexPosition.push([-8.774939,-1.640293,-12.831503]);
vertexPosition.push([-8.774939,-0.727868,-12.831503]);
vertexPosition.push([-17.382034,3.711825,2.588121]);
vertexPosition.push([-16.479696,3.711825,2.457149]);
vertexPosition.push([-17.27165,3.711825,3.348619]);
vertexPosition.push([-16.369312,3.711825,3.217647]);
vertexPosition.push([-15.260802,-0.894959,0.50484]);
vertexPosition.push([-15.260802,0.557948,0.50484]);
vertexPosition.push([-15.150418,-0.894959,1.265338]);
vertexPosition.push([-15.150418,0.557948,1.265338]);
vertexPosition.push([-14.981787,-0.904807,-2.753613]);
vertexPosition.push([-14.002379,-0.904807,4.307486]);
vertexPosition.push([-19.198992,-0.904807,-2.168667]);
vertexPosition.push([-18.219584,-0.904807,4.892432]);
vertexPosition.push([-16.296875,3.352771,0.351964]);
vertexPosition.push([-14.981787,1.62348,-2.753613]);
vertexPosition.push([-16.113075,3.352771,1.677082]);
vertexPosition.push([-14.002379,1.62348,4.307486]);
vertexPosition.push([-17.088295,3.352771,0.461737]);
vertexPosition.push([-19.198992,1.62348,-2.168667]);
vertexPosition.push([-16.904495,3.352771,1.786855]);
vertexPosition.push([-18.219584,1.62348,4.892432]);
vertexPosition.push([-18.957781,-0.07427,-0.429651]);
vertexPosition.push([-14.740578,-0.07427,-1.014597]);
vertexPosition.push([-14.740578,0.715845,-1.014597]);
vertexPosition.push([-18.957781,0.715845,-0.429651]);
vertexPosition.push([-14.865852,-0.07427,-1.917777]);
vertexPosition.push([-19.083057,-0.07427,-1.332831]);
vertexPosition.push([-19.083057,0.715845,-1.332831]);
vertexPosition.push([-14.865852,0.715845,-1.917777]);
vertexPosition.push([-18.370497,-0.07427,3.804415]);
vertexPosition.push([-14.153293,-0.07427,3.219469]);
vertexPosition.push([-14.153293,0.715845,3.219469]);
vertexPosition.push([-18.370497,0.715845,3.804415]);
vertexPosition.push([-14.278567,-0.07427,2.316289]);
vertexPosition.push([-18.495771,-0.07427,2.901235]);
vertexPosition.push([-18.495771,0.715845,2.901235]);
vertexPosition.push([-14.278567,0.715845,2.316289]);
vertexPosition.push([-16.599583,-0.07427,-2.529217]);
vertexPosition.push([-16.478371,-0.07427,-1.694113]);
vertexPosition.push([-15.864346,-0.07427,2.536244]);
vertexPosition.push([-15.782508,-0.07427,3.100074]);
vertexPosition.push([-15.575583,-0.07427,4.525697]);
vertexPosition.push([-15.733367,-0.07427,3.438632]);
vertexPosition.push([-16.347391,-0.07427,-0.791725]);
vertexPosition.push([-16.478371,0.715845,-1.694113]);
vertexPosition.push([-16.599583,0.715845,-2.529217]);
vertexPosition.push([-16.428356,0.715845,-1.349536]);
vertexPosition.push([-16.347391,0.715845,-0.791725]);
vertexPosition.push([-15.733367,0.715845,3.438632]);
vertexPosition.push([-15.575583,0.715845,4.525697]);
vertexPosition.push([-15.864346,0.715845,2.536244]);
vertexPosition.push([-17.381567,-0.07427,-1.568835]);
vertexPosition.push([-17.502781,-0.07427,-2.403939]);
vertexPosition.push([-16.767544,-0.07427,2.661522]);
vertexPosition.push([-17.250587,-0.07427,-0.666447]);
vertexPosition.push([-17.328651,-0.07427,-1.204261]);
vertexPosition.push([-16.636564,-0.07427,3.56391]);
vertexPosition.push([-16.478781,-0.07427,4.650974]);
vertexPosition.push([-17.502781,0.715845,-2.403939]);
vertexPosition.push([-17.381567,0.715845,-1.568835]);
vertexPosition.push([-16.767544,0.715845,2.661522]);
vertexPosition.push([-17.250587,0.715845,-0.666447]);
vertexPosition.push([-16.478781,0.715845,4.650974]);
vertexPosition.push([-16.636564,0.715845,3.56391]);
vertexPosition.push([-16.649664,0.715845,-1.670354]);
vertexPosition.push([-17.210609,-0.07427,-1.592548]);
vertexPosition.push([-16.390474,0.715845,3.529776]);
vertexPosition.push([-15.979211,-0.07427,3.472732]);
vertexPosition.push([-16.436043,0.715845,2.615541]);
vertexPosition.push([-14.54425,-0.894959,0.400835]);
vertexPosition.push([-14.54425,0.557948,0.400835]);
vertexPosition.push([-14.438669,-0.07427,1.16203]);
vertexPosition.push([-14.438669,-0.894959,1.16203]);
vertexPosition.push([-14.438669,0.557948,1.16203]);
vertexPosition.push([-17.382034,2.769675,2.588121]);
vertexPosition.push([-17.234747,2.918504,2.566742]);
vertexPosition.push([-16.479696,2.921381,2.457149]);
vertexPosition.push([-16.369312,2.462428,3.217647]);
vertexPosition.push([-17.27165,2.458988,3.348619]);
vertexPosition.push([-17.346746,2.771226,2.831233]);
vertexPosition.push([0.634178,3.613408,-15.36438]);
vertexPosition.push([0.00609,3.613408,-14.703418]);
vertexPosition.push([0.077114,3.613408,-15.893739]);
vertexPosition.push([-0.550975,3.613408,-15.232777]);
vertexPosition.push([0.255624,-0.993377,-12.415417]);
vertexPosition.push([0.255624,0.45953,-12.415417]);
vertexPosition.push([-0.30144,-0.993377,-12.944776]);
vertexPosition.push([-0.30144,0.45953,-12.944776]);
vertexPosition.push([2.051517,-1.003225,-9.682262]);
vertexPosition.push([-3.084989,-1.003225,-14.625405]);
vertexPosition.push([5.003783,-1.003225,-12.750014]);
vertexPosition.push([-0.132723,-1.003225,-17.693157]);
vertexPosition.push([1.164349,3.254353,-12.936029]);
vertexPosition.push([2.051517,1.525062,-9.682262]);
vertexPosition.push([0.200409,3.254353,-13.863683]);
vertexPosition.push([-3.084989,1.525062,-14.625405]);
vertexPosition.push([1.718385,3.254353,-13.511737]);
vertexPosition.push([5.003783,1.525062,-12.750014]);
vertexPosition.push([0.754445,3.254353,-14.43939]);
vertexPosition.push([-0.132723,1.525062,-17.693157]);
vertexPosition.push([3.738759,-0.172688,-13.967417]);
vertexPosition.push([0.786493,-0.172688,-10.899666]);
vertexPosition.push([0.786493,0.617428,-10.899666]);
vertexPosition.push([3.738759,0.617428,-13.967417]);
vertexPosition.push([1.443499,-0.172688,-10.267392]);
vertexPosition.push([4.395765,-0.172688,-13.335143]);
vertexPosition.push([4.395765,0.617428,-13.335143]);
vertexPosition.push([1.443499,0.617428,-10.267392]);
vertexPosition.push([0.658742,-0.172688,-16.931488]);
vertexPosition.push([-2.293524,-0.172688,-13.863736]);
vertexPosition.push([-2.293524,0.617428,-13.863736]);
vertexPosition.push([0.658742,0.617428,-16.931488]);
vertexPosition.push([-1.636518,-0.172688,-13.231462]);
vertexPosition.push([1.315748,-0.172688,-16.299213]);
vertexPosition.push([1.315748,0.617428,-16.299213]);
vertexPosition.push([-1.636518,0.617428,-13.231462]);
vertexPosition.push([3.18406,-0.172688,-10.859108]);
vertexPosition.push([2.572347,-0.172688,-11.440397]);
vertexPosition.push([-0.526389,-0.172688,-14.385016]);
vertexPosition.push([-0.939394,-0.172688,-14.777481]);
vertexPosition.push([-1.983663,-0.172688,-15.769813]);
vertexPosition.push([-1.187388,-0.172688,-15.013141]);
vertexPosition.push([1.911347,-0.172688,-12.068521]);
vertexPosition.push([2.572347,0.617428,-11.440397]);
vertexPosition.push([3.18406,0.617428,-10.859108]);
vertexPosition.push([2.319944,0.617428,-11.680246]);
vertexPosition.push([1.911347,0.617428,-12.068521]);
vertexPosition.push([-1.187388,0.617428,-15.013141]);
vertexPosition.push([-1.983663,0.617428,-15.769813]);
vertexPosition.push([-0.526389,0.617428,-14.385016]);
vertexPosition.push([3.204633,-0.172688,-12.097417]);
vertexPosition.push([3.816346,-0.172688,-11.516127]);
vertexPosition.push([0.105897,-0.172688,-15.042036]);
vertexPosition.push([2.543633,-0.172688,-12.725541]);
vertexPosition.push([2.937582,-0.172688,-12.351185]);
vertexPosition.push([-0.555103,-0.172688,-15.67016]);
vertexPosition.push([-1.351377,-0.172688,-16.426832]);
vertexPosition.push([3.816346,0.617428,-11.516127]);
vertexPosition.push([3.204633,0.617428,-12.097417]);
vertexPosition.push([0.105897,0.617428,-15.042036]);
vertexPosition.push([2.543633,0.617428,-12.725541]);
vertexPosition.push([-1.351377,0.617428,-16.426832]);
vertexPosition.push([-0.555103,0.617428,-15.67016]);
vertexPosition.push([2.692261,0.617428,-11.565002]);
vertexPosition.push([3.084953,-0.172688,-11.973055]);
vertexPosition.push([-0.727378,0.617428,-15.491145]);
vertexPosition.push([-1.015285,-0.172688,-15.191977]);
vertexPosition.push([-0.126171,0.617428,-14.80089]);
vertexPosition.push([-0.243145,-0.993377,-11.890543]);
vertexPosition.push([-0.243145,0.45953,-11.890543]);
vertexPosition.push([-0.796866,-0.172688,-12.42342]);
vertexPosition.push([-0.796866,-0.993377,-12.42342]);
vertexPosition.push([-0.796866,0.45953,-12.42342]);
vertexPosition.push([0.634178,2.671257,-15.36438]);
vertexPosition.push([0.531655,2.820086,-15.256492]);
vertexPosition.push([0.00609,2.822963,-14.703418]);
vertexPosition.push([-0.550975,2.36401,-15.232777]);
vertexPosition.push([0.077114,2.36057,-15.893739]);
vertexPosition.push([0.456099,2.672808,-15.533603]);
vertexPosition.push([0.27088,3.685929,8.608658]);
vertexPosition.push([-0.357017,3.685929,7.947514]);
vertexPosition.push([0.828099,3.685929,8.079461]);
vertexPosition.push([0.200202,3.685929,7.418317]);
vertexPosition.push([-2.654801,-0.920856,8.079435]);
vertexPosition.push([-2.654801,0.532051,8.079435]);
vertexPosition.push([-2.097582,-0.920856,7.550238]);
vertexPosition.push([-2.097582,0.532051,7.550238]);
vertexPosition.push([-5.476421,-0.930703,9.732862]);
vertexPosition.push([-0.276475,-0.930703,4.8565]);
vertexPosition.push([-2.564039,-0.930703,12.838503]);
vertexPosition.push([2.635907,-0.930703,7.962141]);
vertexPosition.push([-2.181455,3.326874,9.013653]);
vertexPosition.push([-5.476421,1.597584,9.732862]);
vertexPosition.push([-1.205609,3.326874,8.098532]);
vertexPosition.push([-0.276475,1.597584,4.8565]);
vertexPosition.push([-1.634905,3.326874,9.596472]);
vertexPosition.push([-2.564039,1.597584,12.838503]);
vertexPosition.push([-0.659058,3.326874,8.681351]);
vertexPosition.push([2.635907,1.597584,7.962141]);
vertexPosition.push([-1.28339,-0.100167,11.637547]);
vertexPosition.push([-4.195772,-0.100167,8.531907]);
vertexPosition.push([-4.195772,0.689949,8.531907]);
vertexPosition.push([-1.28339,0.689949,11.637547]);
vertexPosition.push([-4.860893,-0.100167,9.155639]);
vertexPosition.push([-1.948511,-0.100167,12.261279]);
vertexPosition.push([-1.948511,0.689949,12.261279]);
vertexPosition.push([-4.860893,0.689949,9.155639]);
vertexPosition.push([1.834667,-0.100167,8.71352]);
vertexPosition.push([-1.077714,-0.100167,5.60788]);
vertexPosition.push([-1.077714,0.689949,5.60788]);
vertexPosition.push([1.834667,0.689949,8.71352]);
vertexPosition.push([-1.742835,-0.100167,6.231612]);
vertexPosition.push([1.169547,-0.100167,9.337252]);
vertexPosition.push([1.169547,0.689949,9.337252]);
vertexPosition.push([-1.742835,0.689949,6.231612]);
vertexPosition.push([-4.359179,-0.100167,10.924243]);
vertexPosition.push([-3.747296,-0.100167,10.343131]);
vertexPosition.push([-0.647704,-0.100167,7.399413]);
vertexPosition.push([-0.234585,-0.100167,7.007069]);
vertexPosition.push([0.809973,-0.100167,6.015041]);
vertexPosition.push([0.013478,-0.100167,6.771481]);
vertexPosition.push([-3.086114,-0.100167,9.715199]);
vertexPosition.push([-3.747296,0.689949,10.343131]);
vertexPosition.push([-4.359179,0.689949,10.924243]);
vertexPosition.push([-3.494824,0.689949,10.103355]);
vertexPosition.push([-3.086114,0.689949,9.715199]);
vertexPosition.push([0.013478,0.689949,6.771481]);
vertexPosition.push([0.809973,0.689949,6.015041]);
vertexPosition.push([-0.647704,0.689949,7.399413]);
vertexPosition.push([-3.123552,-0.100167,11.008265]);
vertexPosition.push([-3.735435,-0.100167,11.589376]);
vertexPosition.push([-0.02396,-0.100167,8.064548]);
vertexPosition.push([-2.46237,-0.100167,10.380333]);
vertexPosition.push([-2.856428,-0.100167,10.754575]);
vertexPosition.push([0.637222,-0.100167,7.436615]);
vertexPosition.push([1.433717,-0.100167,6.680175]);
vertexPosition.push([-3.735435,0.689949,11.589376]);
vertexPosition.push([-3.123552,0.689949,11.008265]);
vertexPosition.push([-0.02396,0.689949,8.064548]);
vertexPosition.push([-2.46237,0.689949,10.380333]);
vertexPosition.push([1.433717,0.689949,6.680175]);
vertexPosition.push([0.637222,0.689949,7.436615]);
vertexPosition.push([-3.629002,0.689949,10.469275]);
vertexPosition.push([-3.241615,-0.100167,10.882368]);
vertexPosition.push([0.467274,0.689949,7.25539]);
vertexPosition.push([0.183257,-0.100167,6.952526]);
vertexPosition.push([-0.252893,0.689949,7.820423]);
vertexPosition.push([-3.153418,-0.920856,7.554416]);
vertexPosition.push([-3.153418,0.532051,7.554416]);
vertexPosition.push([-2.592857,-0.100167,7.028738]);
vertexPosition.push([-2.592857,-0.920856,7.028738]);
vertexPosition.push([-2.592857,0.532051,7.028738]);
vertexPosition.push([0.27088,2.743778,8.608658]);
vertexPosition.push([0.168389,2.892607,8.500739]);
vertexPosition.push([-0.357017,2.895485,7.947514]);
vertexPosition.push([0.200202,2.436531,7.418317]);
vertexPosition.push([0.828099,2.433092,8.079461]);
vertexPosition.push([0.449009,2.74533,8.439487]);

index.push([11,13,15]);
index.push([16,7,8]);
index.push([10,6,5]);
index.push([6,7,5]);
index.push([19,17,20]);
index.push([21,24,23]);
index.push([22,17,18]);
index.push([24,20,23]);
index.push([6,20,17]);
index.push([9,11,10]);
index.push([11,12,10]);
index.push([11,15,12]);
index.push([15,16,12]);
index.push([15,13,16]);
index.push([13,14,16]);
index.push([13,9,14]);
index.push([9,10,14]);
index.push([19,5,18]);
index.push([25,27,26]);
index.push([32,30,29]);
index.push([29,25,26]);
index.push([28,32,27]);
index.push([8,31,16]);
index.push([7,32,29]);
index.push([22,7,26]);
index.push([1,33,34]);
index.push([3,37,36]);
index.push([2,3,1]);
index.push([33,3,36]);
index.push([4,35,37]);
index.push([21,35,34]);
index.push([36,8,6]);
index.push([11,9,13]);
index.push([16,14,7]);
index.push([10,12,6]);
index.push([6,8,7]);
index.push([19,18,17]);
index.push([21,22,24]);
index.push([22,21,17]);
index.push([24,19,20]);
index.push([6,12,20]);
index.push([19,10,5]);
index.push([25,28,27]);
index.push([32,31,30]);
index.push([29,30,25]);
index.push([28,31,32]);
index.push([8,30,31]);
index.push([7,14,32]);
index.push([27,32,14]);
index.push([14,10,27]);
index.push([10,19,24]);
index.push([10,24,27]);
index.push([22,18,5]);
index.push([27,24,26]);
index.push([24,22,26]);
index.push([7,29,26]);
index.push([22,5,7]);
index.push([34,35,2]);
index.push([2,1,34]);
index.push([3,4,37]);
index.push([2,4,3]);
index.push([33,1,3]);
index.push([4,2,35]);
index.push([21,23,35]);
index.push([37,35,23]);
index.push([23,20,12]);
index.push([12,16,28]);
index.push([16,31,28]);
index.push([37,23,28]);
index.push([23,12,28]);
index.push([25,30,36]);
index.push([30,8,36]);
index.push([37,28,25]);
index.push([36,37,25]);
index.push([6,17,33]);
index.push([17,21,33]);
index.push([21,34,33]);
index.push([33,36,6]);
index.push([48,50,52]);
index.push([53,44,45]);
index.push([47,43,42]);
index.push([43,44,42]);
index.push([56,54,57]);
index.push([58,61,60]);
index.push([59,54,55]);
index.push([61,57,60]);
index.push([43,57,54]);
index.push([46,48,47]);
index.push([48,49,47]);
index.push([48,52,49]);
index.push([52,53,49]);
index.push([52,50,53]);
index.push([50,51,53]);
index.push([50,46,51]);
index.push([46,47,51]);
index.push([56,42,55]);
index.push([62,64,63]);
index.push([69,67,66]);
index.push([66,62,63]);
index.push([65,69,64]);
index.push([45,68,53]);
index.push([44,69,66]);
index.push([59,44,63]);
index.push([38,70,71]);
index.push([40,74,73]);
index.push([39,40,38]);
index.push([70,40,73]);
index.push([41,72,74]);
index.push([58,72,71]);
index.push([73,45,43]);
index.push([48,46,50]);
index.push([53,51,44]);
index.push([47,49,43]);
index.push([43,45,44]);
index.push([56,55,54]);
index.push([58,59,61]);
index.push([59,58,54]);
index.push([61,56,57]);
index.push([43,49,57]);
index.push([56,47,42]);
index.push([62,65,64]);
index.push([69,68,67]);
index.push([66,67,62]);
index.push([65,68,69]);
index.push([45,67,68]);
index.push([44,51,69]);
index.push([64,69,51]);
index.push([51,47,64]);
index.push([47,56,61]);
index.push([47,61,64]);
index.push([59,55,42]);
index.push([64,61,63]);
index.push([61,59,63]);
index.push([44,66,63]);
index.push([59,42,44]);
index.push([71,72,39]);
index.push([39,38,71]);
index.push([40,41,74]);
index.push([39,41,40]);
index.push([70,38,40]);
index.push([41,39,72]);
index.push([58,60,72]);
index.push([74,72,60]);
index.push([60,57,49]);
index.push([49,53,65]);
index.push([53,68,65]);
index.push([74,60,65]);
index.push([60,49,65]);
index.push([62,67,73]);
index.push([67,45,73]);
index.push([74,65,62]);
index.push([73,74,62]);
index.push([43,54,70]);
index.push([54,58,70]);
index.push([58,71,70]);
index.push([70,73,43]);
index.push([85,87,89]);
index.push([90,81,82]);
index.push([84,80,79]);
index.push([80,81,79]);
index.push([93,91,94]);
index.push([95,98,97]);
index.push([96,91,92]);
index.push([98,94,97]);
index.push([80,94,91]);
index.push([83,85,84]);
index.push([85,86,84]);
index.push([85,89,86]);
index.push([89,90,86]);
index.push([89,87,90]);
index.push([87,88,90]);
index.push([87,83,88]);
index.push([83,84,88]);
index.push([93,79,92]);
index.push([99,101,100]);
index.push([106,104,103]);
index.push([103,99,100]);
index.push([102,106,101]);
index.push([82,105,90]);
index.push([81,106,103]);
index.push([96,81,100]);
index.push([75,107,108]);
index.push([77,111,110]);
index.push([76,77,75]);
index.push([107,77,110]);
index.push([78,109,111]);
index.push([95,109,108]);
index.push([110,82,80]);
index.push([85,83,87]);
index.push([90,88,81]);
index.push([84,86,80]);
index.push([80,82,81]);
index.push([93,92,91]);
index.push([95,96,98]);
index.push([96,95,91]);
index.push([98,93,94]);
index.push([80,86,94]);
index.push([93,84,79]);
index.push([99,102,101]);
index.push([106,105,104]);
index.push([103,104,99]);
index.push([102,105,106]);
index.push([82,104,105]);
index.push([81,88,106]);
index.push([101,106,88]);
index.push([88,84,101]);
index.push([84,93,98]);
index.push([84,98,101]);
index.push([96,92,79]);
index.push([101,98,100]);
index.push([98,96,100]);
index.push([81,103,100]);
index.push([96,79,81]);
index.push([108,109,76]);
index.push([76,75,108]);
index.push([77,78,111]);
index.push([76,78,77]);
index.push([107,75,77]);
index.push([78,76,109]);
index.push([95,97,109]);
index.push([111,109,97]);
index.push([97,94,86]);
index.push([86,90,102]);
index.push([90,105,102]);
index.push([111,97,102]);
index.push([97,86,102]);
index.push([99,104,110]);
index.push([104,82,110]);
index.push([111,102,99]);
index.push([110,111,99]);
index.push([80,91,107]);
index.push([91,95,107]);
index.push([95,108,107]);
index.push([107,110,80]);
index.push([113,114,115]);
index.push([126,128,130]);
index.push([123,120,121]);
index.push([124,127,125]);
index.push([128,125,129]);
index.push([138,122,137]);
index.push([120,139,136]);
index.push([146,129,135]);
index.push([123,143,140]);
index.push([121,142,127]);
index.push([161,154,150]);
index.push([156,149,155]);
index.push([159,152,160]);
index.push([163,170,162]);
index.push([167,173,168]);
index.push([165,171,164]);
index.push([163,162,176]);
index.push([164,154,165]);
index.push([152,153,178]);
index.push([179,172,158]);
index.push([173,174,177]);
index.push([156,155,175]);
index.push([121,160,152]);
index.push([131,123,173]);
index.push([169,163,122]);
index.push([120,156,125]);
index.push([133,158,134]);
index.push([132,172,165]);
index.push([138,162,170]);
index.push([139,149,136]);
index.push([132,166,137]);
index.push([154,136,149]);
index.push([162,166,176]);
index.push([165,176,166]);
index.push([135,170,172]);
index.push([134,158,157]);
index.push([157,175,155]);
index.push([158,175,157]);
index.push([142,153,159]);
index.push([143,167,140]);
index.push([146,164,171]);
index.push([147,150,144]);
index.push([164,140,167]);
index.push([144,150,151]);
index.push([153,151,178]);
index.push([164,167,178]);
index.push([143,171,174]);
index.push([147,159,161]);
index.push([159,179,161]);
index.push([171,177,174]);
index.push([116,181,117]);
index.push([119,184,182]);
index.push([116,119,118]);
index.push([180,118,183]);
index.push([119,181,184]);
index.push([120,133,180]);
index.push([144,184,147]);
index.push([113,187,186]);
index.push([187,115,188]);
index.push([188,114,189]);
index.push([112,185,190]);
index.push([188,131,127]);
index.push([131,190,185]);
index.push([113,112,114]);
index.push([126,124,128]);
index.push([123,122,120]);
index.push([124,126,127]);
index.push([128,124,125]);
index.push([138,129,122]);
index.push([120,125,139]);
index.push([132,137,122]);
index.push([122,123,145]);
index.push([123,140,145]);
index.push([132,122,145]);
index.push([146,143,131]);
index.push([132,145,146]);
index.push([129,138,135]);
index.push([135,132,146]);
index.push([146,131,129]);
index.push([123,131,143]);
index.push([121,141,142]);
index.push([161,158,154]);
index.push([156,148,149]);
index.push([159,153,152]);
index.push([163,169,170]);
index.push([167,174,173]);
index.push([165,172,171]);
index.push([176,149,148]);
index.push([148,163,176]);
index.push([164,150,154]);
index.push([178,167,168]);
index.push([168,152,178]);
index.push([158,161,179]);
index.push([179,171,172]);
index.push([159,160,177]);
index.push([160,173,177]);
index.push([170,169,175]);
index.push([169,156,175]);
index.push([121,127,160]);
index.push([173,160,127]);
index.push([123,121,168]);
index.push([121,152,168]);
index.push([173,127,131]);
index.push([123,168,173]);
index.push([163,148,120]);
index.push([129,125,169]);
index.push([125,156,169]);
index.push([163,120,122]);
index.push([129,169,122]);
index.push([120,148,156]);
index.push([133,154,158]);
index.push([132,135,172]);
index.push([138,137,162]);
index.push([139,155,149]);
index.push([165,166,132]);
index.push([166,162,137]);
index.push([154,133,136]);
index.push([165,154,176]);
index.push([154,149,176]);
index.push([135,138,170]);
index.push([157,155,139]);
index.push([139,134,157]);
index.push([158,172,175]);
index.push([172,170,175]);
index.push([142,141,153]);
index.push([143,174,167]);
index.push([146,145,164]);
index.push([147,161,150]);
index.push([164,145,140]);
index.push([151,153,141]);
index.push([141,144,151]);
index.push([178,151,150]);
index.push([150,164,178]);
index.push([143,146,171]);
index.push([147,142,159]);
index.push([159,177,179]);
index.push([171,179,177]);
index.push([116,180,181]);
index.push([183,118,182]);
index.push([118,119,182]);
index.push([116,117,119]);
index.push([180,116,118]);
index.push([119,117,181]);
index.push([182,144,183]);
index.push([144,141,121]);
index.push([120,136,133]);
index.push([134,139,125]);
index.push([134,125,181]);
index.push([125,127,181]);
index.push([127,142,147]);
index.push([147,184,181]);
index.push([127,147,181]);
index.push([144,121,183]);
index.push([180,183,121]);
index.push([134,181,133]);
index.push([181,180,133]);
index.push([180,121,120]);
index.push([144,182,184]);
index.push([186,185,112]);
index.push([112,113,186]);
index.push([187,113,115]);
index.push([188,115,114]);
index.push([190,189,114]);
index.push([114,112,190]);
index.push([189,190,131]);
index.push([127,126,188]);
index.push([126,130,187]);
index.push([130,186,187]);
index.push([188,189,131]);
index.push([126,187,188]);
index.push([185,186,130]);
index.push([130,128,185]);
index.push([128,129,185]);
index.push([129,131,185]);
index.push([192,193,194]);
index.push([205,207,209]);
index.push([202,199,200]);
index.push([203,206,204]);
index.push([207,204,208]);
index.push([217,201,216]);
index.push([199,218,215]);
index.push([225,208,214]);
index.push([202,222,219]);
index.push([200,221,206]);
index.push([240,233,229]);
index.push([235,228,234]);
index.push([238,231,239]);
index.push([242,249,241]);
index.push([246,252,247]);
index.push([244,250,243]);
index.push([242,241,255]);
index.push([243,233,244]);
index.push([231,232,257]);
index.push([258,251,237]);
index.push([252,253,256]);
index.push([235,234,254]);
index.push([200,239,231]);
index.push([210,202,252]);
index.push([248,242,201]);
index.push([199,235,204]);
index.push([212,237,213]);
index.push([211,251,244]);
index.push([217,241,249]);
index.push([218,228,215]);
index.push([211,245,216]);
index.push([233,215,228]);
index.push([241,245,255]);
index.push([244,255,245]);
index.push([214,249,251]);
index.push([213,237,236]);
index.push([236,254,234]);
index.push([237,254,236]);
index.push([221,232,238]);
index.push([222,246,219]);
index.push([225,243,250]);
index.push([226,229,223]);
index.push([243,219,246]);
index.push([223,229,230]);
index.push([232,230,257]);
index.push([243,246,257]);
index.push([222,250,253]);
index.push([226,238,240]);
index.push([238,258,240]);
index.push([250,256,253]);
index.push([195,260,196]);
index.push([198,263,261]);
index.push([195,198,197]);
index.push([259,197,262]);
index.push([198,260,263]);
index.push([199,212,259]);
index.push([223,263,226]);
index.push([192,266,265]);
index.push([266,194,267]);
index.push([267,193,268]);
index.push([191,264,269]);
index.push([267,210,206]);
index.push([210,269,264]);
index.push([192,191,193]);
index.push([205,203,207]);
index.push([202,201,199]);
index.push([203,205,206]);
index.push([207,203,204]);
index.push([217,208,201]);
index.push([199,204,218]);
index.push([211,216,201]);
index.push([201,202,224]);
index.push([202,219,224]);
index.push([211,201,224]);
index.push([225,222,210]);
index.push([211,224,225]);
index.push([208,217,214]);
index.push([214,211,225]);
index.push([225,210,208]);
index.push([202,210,222]);
index.push([200,220,221]);
index.push([240,237,233]);
index.push([235,227,228]);
index.push([238,232,231]);
index.push([242,248,249]);
index.push([246,253,252]);
index.push([244,251,250]);
index.push([255,228,227]);
index.push([227,242,255]);
index.push([243,229,233]);
index.push([257,246,247]);
index.push([247,231,257]);
index.push([237,240,258]);
index.push([258,250,251]);
index.push([238,239,256]);
index.push([239,252,256]);
index.push([249,248,254]);
index.push([248,235,254]);
index.push([200,206,239]);
index.push([252,239,206]);
index.push([202,200,247]);
index.push([200,231,247]);
index.push([252,206,210]);
index.push([202,247,252]);
index.push([242,227,199]);
index.push([208,204,248]);
index.push([204,235,248]);
index.push([242,199,201]);
index.push([208,248,201]);
index.push([199,227,235]);
index.push([212,233,237]);
index.push([211,214,251]);
index.push([217,216,241]);
index.push([218,234,228]);
index.push([244,245,211]);
index.push([245,241,216]);
index.push([233,212,215]);
index.push([244,233,255]);
index.push([233,228,255]);
index.push([214,217,249]);
index.push([236,234,218]);
index.push([218,213,236]);
index.push([237,251,254]);
index.push([251,249,254]);
index.push([221,220,232]);
index.push([222,253,246]);
index.push([225,224,243]);
index.push([226,240,229]);
index.push([243,224,219]);
index.push([230,232,220]);
index.push([220,223,230]);
index.push([257,230,229]);
index.push([229,243,257]);
index.push([222,225,250]);
index.push([226,221,238]);
index.push([238,256,258]);
index.push([250,258,256]);
index.push([195,259,260]);
index.push([262,197,261]);
index.push([197,198,261]);
index.push([195,196,198]);
index.push([259,195,197]);
index.push([198,196,260]);
index.push([261,223,262]);
index.push([223,220,200]);
index.push([199,215,212]);
index.push([213,218,204]);
index.push([213,204,260]);
index.push([204,206,260]);
index.push([206,221,226]);
index.push([226,263,260]);
index.push([206,226,260]);
index.push([223,200,262]);
index.push([259,262,200]);
index.push([213,260,212]);
index.push([260,259,212]);
index.push([259,200,199]);
index.push([223,261,263]);
index.push([265,264,191]);
index.push([191,192,265]);
index.push([266,192,194]);
index.push([267,194,193]);
index.push([269,268,193]);
index.push([193,191,269]);
index.push([268,269,210]);
index.push([206,205,267]);
index.push([205,209,266]);
index.push([209,265,266]);
index.push([267,268,210]);
index.push([205,266,267]);
index.push([264,265,209]);
index.push([209,207,264]);
index.push([207,208,264]);
index.push([208,210,264]);
index.push([271,272,273]);
index.push([284,286,288]);
index.push([281,278,279]);
index.push([282,285,283]);
index.push([286,283,287]);
index.push([296,280,295]);
index.push([278,297,294]);
index.push([304,287,293]);
index.push([281,301,298]);
index.push([279,300,285]);
index.push([319,312,308]);
index.push([314,307,313]);
index.push([317,310,318]);
index.push([321,328,320]);
index.push([325,331,326]);
index.push([323,329,322]);
index.push([321,320,334]);
index.push([322,312,323]);
index.push([310,311,336]);
index.push([337,330,316]);
index.push([331,332,335]);
index.push([314,313,333]);
index.push([279,318,310]);
index.push([289,281,331]);
index.push([327,321,280]);
index.push([278,314,283]);
index.push([291,316,292]);
index.push([290,330,323]);
index.push([296,320,328]);
index.push([297,307,294]);
index.push([290,324,295]);
index.push([312,294,307]);
index.push([320,324,334]);
index.push([323,334,324]);
index.push([293,328,330]);
index.push([292,316,315]);
index.push([315,333,313]);
index.push([316,333,315]);
index.push([300,311,317]);
index.push([301,325,298]);
index.push([304,322,329]);
index.push([305,308,302]);
index.push([322,298,325]);
index.push([302,308,309]);
index.push([311,309,336]);
index.push([322,325,336]);
index.push([301,329,332]);
index.push([305,317,319]);
index.push([317,337,319]);
index.push([329,335,332]);
index.push([274,339,275]);
index.push([277,342,340]);
index.push([274,277,276]);
index.push([338,276,341]);
index.push([277,339,342]);
index.push([278,291,338]);
index.push([302,342,305]);
index.push([271,345,344]);
index.push([345,273,346]);
index.push([346,272,347]);
index.push([270,343,348]);
index.push([346,289,285]);
index.push([289,348,343]);
index.push([271,270,272]);
index.push([284,282,286]);
index.push([281,280,278]);
index.push([282,284,285]);
index.push([286,282,283]);
index.push([296,287,280]);
index.push([278,283,297]);
index.push([290,295,280]);
index.push([280,281,303]);
index.push([281,298,303]);
index.push([290,280,303]);
index.push([304,301,289]);
index.push([290,303,304]);
index.push([287,296,293]);
index.push([293,290,304]);
index.push([304,289,287]);
index.push([281,289,301]);
index.push([279,299,300]);
index.push([319,316,312]);
index.push([314,306,307]);
index.push([317,311,310]);
index.push([321,327,328]);
index.push([325,332,331]);
index.push([323,330,329]);
index.push([334,307,306]);
index.push([306,321,334]);
index.push([322,308,312]);
index.push([336,325,326]);
index.push([326,310,336]);
index.push([316,319,337]);
index.push([337,329,330]);
index.push([317,318,335]);
index.push([318,331,335]);
index.push([328,327,333]);
index.push([327,314,333]);
index.push([279,285,318]);
index.push([331,318,285]);
index.push([281,279,326]);
index.push([279,310,326]);
index.push([331,285,289]);
index.push([281,326,331]);
index.push([321,306,278]);
index.push([287,283,327]);
index.push([283,314,327]);
index.push([321,278,280]);
index.push([287,327,280]);
index.push([278,306,314]);
index.push([291,312,316]);
index.push([290,293,330]);
index.push([296,295,320]);
index.push([297,313,307]);
index.push([323,324,290]);
index.push([324,320,295]);
index.push([312,291,294]);
index.push([323,312,334]);
index.push([312,307,334]);
index.push([293,296,328]);
index.push([315,313,297]);
index.push([297,292,315]);
index.push([316,330,333]);
index.push([330,328,333]);
index.push([300,299,311]);
index.push([301,332,325]);
index.push([304,303,322]);
index.push([305,319,308]);
index.push([322,303,298]);
index.push([309,311,299]);
index.push([299,302,309]);
index.push([336,309,308]);
index.push([308,322,336]);
index.push([301,304,329]);
index.push([305,300,317]);
index.push([317,335,337]);
index.push([329,337,335]);
index.push([274,338,339]);
index.push([341,276,340]);
index.push([276,277,340]);
index.push([274,275,277]);
index.push([338,274,276]);
index.push([277,275,339]);
index.push([340,302,341]);
index.push([302,299,279]);
index.push([278,294,291]);
index.push([292,297,283]);
index.push([292,283,339]);
index.push([283,285,339]);
index.push([285,300,305]);
index.push([305,342,339]);
index.push([285,305,339]);
index.push([302,279,341]);
index.push([338,341,279]);
index.push([292,339,291]);
index.push([339,338,291]);
index.push([338,279,278]);
index.push([302,340,342]);
index.push([344,343,270]);
index.push([270,271,344]);
index.push([345,271,273]);
index.push([346,273,272]);
index.push([348,347,272]);
index.push([272,270,348]);
index.push([347,348,289]);
index.push([285,284,346]);
index.push([284,288,345]);
index.push([288,344,345]);
index.push([346,347,289]);
index.push([284,345,346]);
index.push([343,344,288]);
index.push([288,286,343]);
index.push([286,287,343]);
index.push([287,289,343]);



  return [indexes, vertexPosition, vertexNormal];
}


function startGL() 
{
  alert("StartGL");
  let canvas = document.getElementById("canvas3D"); //wyszukanie obiektu w strukturze strony 
  gl = canvas.getContext("experimental-webgl"); //pobranie kontekstu OpenGL'u z obiektu canvas
  gl.viewportWidth = canvas.width; //przypisanie wybranej przez nas rozdzielczości do systemu OpenGL
  gl.viewportHeight = canvas.height;
  
    //Kod shaderów
  const vertextShaderSource = ` //Znak akcentu z przycisku tyldy - na lewo od przycisku 1 na klawiaturze
    precision highp float;
    attribute vec3 aVertexPosition; 
    attribute vec3 aVertexNormal;
    uniform mat4 uMMatrix;
    uniform mat4 uInvMMatrix;
    uniform mat4 uVMatrix;
    uniform mat4 uPMatrix;
    varying vec3 vPos;
    varying vec3 vNormal;
    uniform float uNormalMul;
    void main(void) {
      vPos = vec3(uMMatrix * vec4(aVertexPosition, 1.0));
      gl_Position = uPMatrix * uVMatrix * vec4(vPos,1.0); //Dokonanie transformacji położenia punktów z przestrzeni 3D do przestrzeni obrazu (2D)
      vNormal = normalize(mat3(uInvMMatrix) * uNormalMul*aVertexNormal); //Obrot wektorow normalnych
    }
  `;
  const fragmentShaderSource = `
    precision highp float;
    varying vec3 vPos;
    varying vec3 vNormal;
    uniform sampler2D uSampler;
    uniform vec3 uLightPosition;
    uniform vec3 uColor;
    void main(void) {
       vec3 lightDirection = normalize(uLightPosition - vPos);
       float brightness = max(dot(vNormal,lightDirection), 0.0);
      //gl_FragColor = vec4(vColor,1.0); //Ustalenie stałego koloru wszystkich punktów sceny
      //gl_FragColor = texture2D(uSampler,vTexUV)*vec4(vColor,1.0); //Odczytanie punktu tekstury i przypisanie go jako koloru danego punktu renderowaniej figury
      //gl_FragColor = vec4((vNormal+vec3(1.0,1.0,1.0))/2.0,1.0); 
      //gl_FragColor = clamp(texture2D(uSampler,vTexUV) * vec4(brightness,brightness,brightness,1.0),0.0,1.0);
      gl_FragColor = clamp(vec4(uColor,1.0) * vec4(brightness,brightness,brightness,1.0),0.0,1.0);
    }
  `;
  let fragmentShader = gl.createShader(gl.FRAGMENT_SHADER); //Stworzenie obiektu shadera 
  let vertexShader   = gl.createShader(gl.VERTEX_SHADER);
  gl.shaderSource(fragmentShader, fragmentShaderSource); //Podpięcie źródła kodu shader
  gl.shaderSource(vertexShader, vertextShaderSource);
  gl.compileShader(fragmentShader); //Kompilacja kodu shader
  gl.compileShader(vertexShader);
  if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) { //Sprawdzenie ewentualnych błedów kompilacji
    alert(gl.getShaderInfoLog(fragmentShader));
    return null;
  }
  if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) {
    alert(gl.getShaderInfoLog(vertexShader));
    return null;
  }
  
  shaderProgram = gl.createProgram(); //Stworzenie obiektu programu 
  gl.attachShader(shaderProgram, vertexShader); //Podpięcie obu shaderów do naszego programu wykonywanego na karcie graficznej
  gl.attachShader(shaderProgram, fragmentShader);
  gl.linkProgram(shaderProgram);
  if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) alert("Could not initialise shaders");  //Sprawdzenie ewentualnych błedów
  
  //Opis sceny 3D, położenie punktów w przestrzeni 3D w formacie X,Y,Z 
  let vertexPosition; //3 punkty po 3 składowe - X1,Y1,Z1, X2,Y2,Z2, X3,Y3,Z3 - 1 trójkąt
  let vertexNormal;
  let indexes;
  //[vertexPosition, vertexColor, vertexCoords, vertexNormal] = CreateShpere(0,0,0,2, 6, 12); 

  [indexes, vertexPosition, vertexNormal] = CreateVillage(0,0,0,1,1,1);
  vertexPositionBuffer = gl.createBuffer(); //Stworzenie tablicy w pamieci karty graficznej
  gl.bindBuffer(gl.ARRAY_BUFFER, vertexPositionBuffer);
  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertexPosition), gl.STATIC_DRAW);
  vertexPositionBuffer.itemSize = 3; //zdefiniowanie liczby współrzednych per wierzchołek
  vertexPositionBuffer.numItems = vertexPosition.length/9; //Zdefinoiowanie liczby trójkątów w naszym buforze
  
  vertexNormalBuffer = gl.createBuffer();
  gl.bindBuffer(gl.ARRAY_BUFFER, vertexNormalBuffer);
  gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertexNormal), gl.STATIC_DRAW);
  vertexNormalBuffer.itemSize = 3;
  vertexNormalBuffer.numItems = vertexNormal.length/9;
  
  indexBuffer = gl.createBuffer();
  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
  gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indexes), gl.STATIC_DRAW);
  indexBuffer.numItems = indexes.length;

  //Macierze opisujące położenie wirtualnej kamery w przestrzenie 3D
  let aspect = gl.viewportWidth/gl.viewportHeight;
  let fov = 45.0 * Math.PI / 180.0; //Określenie pola widzenia kamery
  let zFar = 100.0; //Ustalenie zakresów renderowania sceny 3D (od obiektu najbliższego zNear do najdalszego zFar)
  let zNear = 0.1;
  uPMatrix = [
   1.0/(aspect*Math.tan(fov/2)),0                           ,0                         ,0                            ,
   0                         ,1.0/(Math.tan(fov/2))         ,0                         ,0                            ,
   0                         ,0                           ,-(zFar+zNear)/(zFar-zNear)  , -1,
   0                         ,0                           ,-(2*zFar*zNear)/(zFar-zNear) ,0.0,
  ];
  Tick();
} 
//let angle = 45.0; //Macierz transformacji świata - określenie położenia kamery 

var angleZ = 0.0;
var angleY = 0.0;
var angleX = 0.0;
var KameraPositionZ = -8.0;

var Object1PositionX = 0.0;
var Object1PositionY = 0.0;
var Object1PositionZ = 0.0;

var Object1AngleZ = 0.0;

var Object2PositionX = 1.0;
var Object2PositionY = 0.0;
var Object2PositionZ = 0.0;

var Object2AngleZ = 0.0;

var Object3PositionX = 1.0;
var Object3PositionY = 0.0;
var Object3PositionZ = 0.0;

var Object3AngleZ = 0.0;

var LightSize = 0.1;
var Object1Sizedx = 1.0;
var Object1Sizedy = 0.2;
var Object1Sizedz = 0.1;
var Object2Sizedx = 1.0;
var Object2Sizedy = 0.2;
var Object2Sizedz = 0.1;
var Object3Sizedx = 0.4;
var Object3Sizedy = 0.2;
var Object3Sizedz = 0.1;

var LightPositionX = 0;
var LightPositionY = 0;
var LightPositionZ = 3;


function Tick()
{ 
  let uMMatrix0 = CreateIdentytyMatrix(); 
  let uMMatrix1 = CreateIdentytyMatrix();
  let uMMatrix2 = CreateIdentytyMatrix();
  let uMMatrix3 = CreateIdentytyMatrix();
  
  let uVMatrix = CreateIdentytyMatrix();
  
  
  uVMatrix = MatrixMul(uVMatrix,CreateRotationXMatrix(angleX));
  uVMatrix = MatrixMul(uVMatrix,CreateRotationYMatrix(angleY));
  uVMatrix = MatrixMul(uVMatrix,CreateRotationZMatrix(angleZ));
  uVMatrix = MatrixMul(uVMatrix,CreateTranslationMatrix(0,0,KameraPositionZ));
  
  uMMatrix1 = MatrixMul(uMMatrix1,CreateScaleMatrix(Object1Sizedx,Object1Sizedy,Object1Sizedz));
  uMMatrix1 = MatrixMul(uMMatrix1,CreateTranslationMatrix(Object1Sizedx,0.0,0.0)); 
  uMMatrix1 = MatrixMul(uMMatrix1,CreateRotationZMatrix(Object1AngleZ));
  uMMatrix1 = MatrixMul(uMMatrix1,CreateTranslationMatrix(Object1PositionX,Object1PositionY,Object1PositionZ));  
  
  uMMatrix2 = MatrixMul(uMMatrix2,CreateScaleMatrix(Object2Sizedx,Object2Sizedy,Object2Sizedz));
  uMMatrix2 = MatrixMul(uMMatrix2,CreateTranslationMatrix(Object2Sizedx,0.0,0.0)); 
  uMMatrix2 = MatrixMul(uMMatrix2,CreateRotationZMatrix(Object2AngleZ));
  uMMatrix2 = MatrixMul(uMMatrix2,CreateTranslationMatrix(Object2PositionX,Object2PositionY,Object2PositionZ));
  
  uMMatrix2 = MatrixMul(uMMatrix2,CreateTranslationMatrix(Object1Sizedx,0.0,0.0)); 
  uMMatrix2 = MatrixMul(uMMatrix2,CreateRotationZMatrix(Object1AngleZ));
  uMMatrix2 = MatrixMul(uMMatrix2,CreateTranslationMatrix(Object1PositionX,Object1PositionY,Object1PositionZ));
  
  uMMatrix3 = MatrixMul(uMMatrix3,CreateScaleMatrix(Object3Sizedx,Object3Sizedy,Object3Sizedz));
  uMMatrix3 = MatrixMul(uMMatrix3,CreateTranslationMatrix(Object3Sizedx,0.0,0.0)); 
  uMMatrix3 = MatrixMul(uMMatrix3,CreateRotationZMatrix(Object3AngleZ));
  uMMatrix3 = MatrixMul(uMMatrix3,CreateTranslationMatrix(Object3PositionX,Object3PositionY,Object3PositionZ));
  
  uMMatrix3 = MatrixMul(uMMatrix3,CreateTranslationMatrix(Object2Sizedx,0.0,0.0)); 
  uMMatrix3 = MatrixMul(uMMatrix3,CreateRotationZMatrix(Object2AngleZ));
  uMMatrix3 = MatrixMul(uMMatrix3,CreateTranslationMatrix(Object2PositionX,Object2PositionY,Object2PositionZ));
  
  uMMatrix3 = MatrixMul(uMMatrix3,CreateTranslationMatrix(Object1Sizedx,0.0,0.0)); 
  uMMatrix3 = MatrixMul(uMMatrix3,CreateRotationZMatrix(Object1AngleZ));
  uMMatrix3 = MatrixMul(uMMatrix3,CreateTranslationMatrix(Object1PositionX,Object1PositionY,Object1PositionZ));
  
  uMMatrix0 = MatrixMul(uMMatrix0,CreateScaleMatrix(LightSize,LightSize,LightSize));
  uMMatrix0 = MatrixMul(uMMatrix0,CreateTranslationMatrix(LightPositionX,LightPositionY,LightPositionZ));
  
  //alert(uPMatrix);
  
  //Render Scene
  gl.viewport(0, 0, gl.viewportWidth, gl.viewportHeight); 
  gl.clearColor(1.0,0.0,0.0,1.0); //Wyczyszczenie obrazu kolorem czerwonym
  gl.clearDepth(1.0);             //Wyczyścienie bufora głebi najdalszym planem
  gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
  gl.useProgram(shaderProgram)   //Użycie przygotowanego programu shaderowego
  
  gl.enable(gl.DEPTH_TEST);           // Włączenie testu głębi - obiekty bliższe mają przykrywać obiekty dalsze
  gl.depthFunc(gl.LEQUAL);            // 
  
  gl.uniformMatrix4fv(gl.getUniformLocation(shaderProgram, "uPMatrix"), false, new Float32Array(uPMatrix)); //Wgranie macierzy kamery do pamięci karty graficznej
  gl.uniformMatrix4fv(gl.getUniformLocation(shaderProgram, "uVMatrix"), false, new Float32Array(uVMatrix));
  gl.uniform1f(gl.getUniformLocation(shaderProgram, "uNormalMul"),1.0);
  gl.uniform3f(gl.getUniformLocation(shaderProgram, "uLightPosition"),LightPositionX,LightPositionY,LightPositionZ);
  
  gl.enableVertexAttribArray(gl.getAttribLocation(shaderProgram, "aVertexPosition"));  //Przekazanie położenia
  gl.bindBuffer(gl.ARRAY_BUFFER, vertexPositionBuffer);
  gl.vertexAttribPointer(gl.getAttribLocation(shaderProgram, "aVertexPosition"), vertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);
  
  
  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer);
  //Obiekt Światła
  gl.uniformMatrix4fv(gl.getUniformLocation(shaderProgram, "uMMatrix"), false, new Float32Array(uMMatrix0));
  gl.uniformMatrix4fv(gl.getUniformLocation(shaderProgram, "uInvMMatrix"), false, new Float32Array(MatrixTransposeInverse(uMMatrix0)));
  gl.uniform3f(gl.getUniformLocation(shaderProgram, "uColor"),1.0,1.0,0.0);
  gl.uniform1f(gl.getUniformLocation(shaderProgram, "uNormalMul"),-1.0);  
  //gl.drawArrays(gl.TRIANGLES, 0, vertexPositionBuffer.numItems*vertexPositionBuffer.itemSize); //Faktyczne wywołanie rendrowania
  gl.drawElements(gl.TRIANGLES, indexBuffer.numItems, gl.UNSIGNED_SHORT, 0);
  
  setTimeout(Tick,100);
}
function handlekeydown(e)
{
 // Q W E A S D
 if(e.keyCode==87) angleX=angleX+1.0; //W
 if(e.keyCode==83) angleX=angleX-1.0; //S
 if(e.keyCode==68) angleY=angleY+1.0;
 if(e.keyCode==65) angleY=angleY-1.0;
 if(e.keyCode==81) angleZ=angleZ+1.0;
 if(e.keyCode==69) angleZ=angleZ-1.0;
 //alert(e.keyCode);
 //alert(angleX);
 
 //U I O J K L
 if(e.keyCode==76) LightPositionX=LightPositionX+0.1;
 if(e.keyCode==74) LightPositionX=LightPositionX-0.1;
 if(e.keyCode==73) LightPositionY=LightPositionY+0.1;
 if(e.keyCode==75) LightPositionY=LightPositionY-0.1;
 if(e.keyCode==85) LightPositionZ=LightPositionZ+0.1;
 if(e.keyCode==79) LightPositionZ=LightPositionZ-0.1;
 
 //Z X
 if(e.keyCode==88) Object1AngleZ=Object1AngleZ-0.1;
 if(e.keyCode==90) Object1AngleZ=Object1AngleZ+0.1;
 
 //C V
 if(e.keyCode==67) Object2AngleZ=Object2AngleZ-0.1;
 if(e.keyCode==86) Object2AngleZ=Object2AngleZ+0.1;
 
 //B N
 if(e.keyCode==66) Object3AngleZ=Object3AngleZ-0.1;
 if(e.keyCode==78) Object3AngleZ=Object3AngleZ+0.1;
}
</script>
</head>
<body onload="startGL()" onkeydown="handlekeydown(event)">
<canvas id="canvas3D" width="640" height="480" style="border: solid black 1px"></canvas>
</body>
</html>